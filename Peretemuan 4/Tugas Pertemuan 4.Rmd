---
title: "Tugas Pertemuan 4"
author: "Ayunda Rasyid Khairunnisa"
date: "2025-09-23"
output: html_document
---

# Tugas Pertemuan 4 MPDW
Nama : Ayunda Rasyid Khairunnisa
NIM : G14012131048

## White Noise
```{r}
set.seed(1048)
wn <- rnorm(300)
ts.plot(wn)
```


## Proses MA
### Pembangkitan Proses MA(2)
Bangkitkan model MA(2) dengan $\theta_1 = 0.4$ dan $\theta_2 = 0.6$ sebanyak 300 observasi (manual dan dengan arima.sim)

### Manual
```{r}
set.seed(1048)
wn <- rnorm(300)
ma2 <- numeric(300)
```
Nilai selanjutnya dapat dicari melalui loop. Bentuk loop dapat dilihat dari rumus MA(2) yang hendak dibangkitkan:
$$y_t = e_t + 0.4 e_{t-1} + 0.6 e_{t-2}$$

```{r}
for(i in 3:300){
   ma2[i-2] <- wn[i] + 0.4  * wn[i - 1] + 0.6 * wn[i-2] 
}
ma2
```
### Arima.sim
```{r}
ma2_A <- arima.sim(list(order=c(0,0,2), ma=c(0.4, 0.6)), n=300)
ma2_A
```
## Karakteristik MA(2)
Untuk melihat karakteristik dari MA(2), digunakan data dari pembangkitan MA(2) secara manual.
### Plot Time Series
```{r}
ts.plot(ma2)
```
Berdasarkan plot time series, terlihat bahwa data MA(2) yang dibangkitkan stasioner dalam rataan

### Plot ACF
```{r}
acf(ma2,lag.max = 20)
```
Berdasarkan plot ACF tersebut, terlihat bahwa plot ACF cuts off di lag  kedua.

### Plot PACF
```{r}
pacf(ma2)
```
Berdasarkan plot PACF tersebut, terlihat bahwa plot PACF cenderung tails off dan membentuk gelombang sinus.

### Plot EACF
```{r}
TSA::eacf(ma2)
```
Berdasarkan pola segitiga nol pada plot EACF, terlihat bahawa segitiga nol berada pada ordo AR(0) dan ordo MA(2)
sehingga mengarah pada ARMA(0,2) atau proses MA(2). Hal ini konsisten dengan data simulasi yang memang dibangkitkan dari proses MA.

## Scatterplot Antar Lag
### Korelasi Antara Yt dengan Yt-1
```{r}
#Yt
yt_ma2 <- ma2[-1]
yt_ma2
```
```{r}
#Yt-1
yt_1_ma2 <- ma2[-300]
yt_1_ma2
```
```{r}
plot(y=yt_ma2,x=yt_1_ma2)
```

```{r}
cor(yt_ma2,yt_1_ma2)
```
Berdasarkan scatterplot tersebut, terlihat bahwa terdapat hubungan positif antara $Y_t$ dengan $Y_t-1$. Hal in sesuai dengan teori yang ada:

Korelasi antara $Y_t$ dengan $Y_t-1$ dari hasil simulasi mendekati perhitungan teoritis yaitu:
$$
\rho_1 = \frac{\gamma_1}{\gamma_0} 
= \frac{\theta_1 + \theta_1 \theta_2}{1 + \theta_1^2 + \theta_2^2} 
= \frac{0.4 + (0.4)(0.6)}{1 + 0.4^2 + 0.6^2} 
= 0.421
$$

Korelasi antara $Y_t$ dengan $Y_t-2$
```{r}
#Yt
yt_ma_2 <- ma2[-c(1,2)]
yt_ma_2
```
```{r}
#Yt-2
yt_2_ma2 <- ma2[-c(299,300)]
yt_2_ma2
```
```{r}
plot(y=yt_ma_2,x=yt_2_ma2)
```
```{r}
cor(yt_ma_2,yt_2_ma2)
```
Berdasarkan scattelerplot tersebut, terlihat bahwa terdapat hubungan positif antara $Y_t$ dengan $Y_t-2$. Hal ini sesuai dengan teori yang ada:

Korelasi antara $Y_t$ dengan $Y_t-2$ dari hasil simulasi mendekati perhitungan teoritis yaitu:
$$
\rho_2 = \frac{\gamma_2}{\gamma_0} 
= \frac{\theta_2}{1 + \theta_1^2 + \theta_2^2} 
= \frac{0.6}{1 + 0.4^2 + 0.6^2} 
= 0.395
$$
### Korelasi antara Yt dengan Tt-3
```{r}
#Yt
yt_ma2_3 <- ma2[-c(1,2,3)]
yt_ma2_3
```
```{r}
#Yt-3
yt_3_ma2 <- ma2[-c(298, 299,300)]
yt_3_ma2
```
```{r}
plot(y=yt_ma2_3,x=yt_3_ma2)
```
```{r}
cor(yt_ma2_3,yt_3_ma2)
```
Berdasarkan scatterplot tersebut, terlihat bahwa cenderung tidak terdapat hubungan antara $Y_t$ dengan $Y_t−3$. Korelasi antara $Y_t$ dengan $Y_t−3$ hasil simulasi mendekati teori yang ada yaitu 0.

## Proses AR(2)
### Pembangkitan Proses AR(2)
Dibangkitkan proses AR(2) dengan $\phi_1 = 0.5$ dan $\phi_2 = 0.2$ sebanyak 300 observasi.
```{r}
set.seed(1048)
ar2 <- wn[1:2]
```
### Manual
```{r}
for (i in 3:300) {    
  ar2[i] <- wn[i] + 0.5 * ar2[i-1] + 0.2 * ar2[i-2]
}
ar2
```
### arima.sim
```{r}
ar2_a<- arima.sim(list(order=c(2,0,0), ar=c(0.5, 0.2)), n=300)
ar2_a
```
## Karakteristik AR(2)
untuk melihat karakteristik dari AR(2), digunakan data dari pembangkitan RA(2) dengan arima.sim.

### Plot Time Series
```{r}
ts.plot(ar2_a)
```
Berdasarkan plot time series tersebut terlihat bahwa data cenderung stasioner pada rataan.

### Plot ACF
```{r}
acf(ar2_a)
```
Berdasarkan plot ACF tersebut terlihat bahwa plot ACF cenderung tails off dan cenderung membentuk pola grafik sinus.

### Plot PACF
```{r}
pacf(ar2_a)
```
Berdasarkan plot PACF tersebut, terlihat bahwa plot PACF cuts off pada lag kedua, sejalan dengan teori yang ada.

### Plot EACF
```{r}
TSA::eacf(ar2_a)
```
Berdasarkan hasil EACF, pola segitiga nol muncul pada (2,2) sehingga mengarah pada ARMA(2,2). Hal ini konsisten dengan model pembangkitan data yang memang menggunakan ARMA(2,2).

## Scattlerplot Antar Lag
### Korelasi antara Yt dengan Yt-1
```{r}
#Yt
yt_ar2 <- ar2_a[-1]
yt_ar2
```
```{r}
#Yt-1
yt_1_ar2 <- ar2_a[-300]
yt_1_ar2
```
```{r}
plot(y=yt_ar2,x=yt_1_ar2)
```
Berdasarkan scatterplot tersebut, terlihat bahwa terdapat hubungan positif antara $Y_t$ dengan $Y_t−1$. Hal ini sesuai dengan teori yang ada.
```{r}
cor(yt_ar2,yt_1_ar2)
```
Korelasi antara $Y_t$ dengan $Y_t−1$ dari hasil simulasi mendekati perhitungan teoritis yaitu:

$$
\rho_1 = \frac{\phi_1}{1 - \phi_2} 
= \frac{0.5}{1 - 0.2} 
= 0.625
$$
### Korelasi antara Yt dengan Yt-2
```{r}
#Yt
yt_ar_2 <- ar2_a[-c(1,2)]
yt_ar_2
```
```{r}
#Yt-2
yt_2_ar2 <- ar2_a[-c(299,300)]
yt_2_ar2
```

```{r}
plot(y=yt_ar_2,x=yt_2_ar2)
```

Berdasarkan scatterplot tersebut, terlihat bahwa terdapat hubungan positif antara $Y_t$ dengan $Y_t−2$. Hal ini sesuai dengan teori yang ada
```{r}
cor(yt_ar_2,yt_2_ar2)
```
Korelasi antara Yt
 dengan Yt−2
 dari hasil simulasi mendekati perhitungan teoritis yaitu:
 
$$
\rho_2 = \frac{\phi_1\rho_1+\phi_2 }{1} 
=\frac{\phi_1^2}{1-\phi_2}
= \frac{0.5^2}{1 - 0.2} 
= 0.5125
$$

### Korelasi antara Yt dengan Yt-3
```{r}
#Yt
yt_ar3 <- ar2_a[-c(1,2,3)]
yt_ar3
```
```{r}
#Yt-3
yt_3_ar2 <- ar2_a[-c(298,299,300)]
yt_3_ar2
```
```{r}
plot(y=yt_ar3,x=yt_3_ar2)
```
Berdasarkan scatterplot tersebut, terlihat bahwa terdapat hubungan positif antara $Y_t$ dengan $Y_t−3$. Hal ini sesuai dengan teori yang ada

```{r}
cor(yt_ar3,yt_3_ar2)
```
Korelasi antara $Y_t$ dengan $Y_t−3$ dari hasil simulasi mendekati perhitungan teoritis yaitu:

$$
\rho_3 = \frac{\phi_1\rho_2+\phi_2\rho1 }{1} 
= 0.5(0.5125) + 0.2(0.625) 
= 0.38125
$$
## Proses ARMA (2,2)
### Pembangkitan Proses ARMA (2,2)
### Manual
```{r}
arma.sim <- function(n, macoef, arcoef){
  manum <- length(macoef)
  arnum <- length(arcoef)
  stopifnot(manum < n & arnum < n)
  
  wn <- rnorm(n, sd = 0.5)
  init <- max(manum, arnum)

  arma <- wn[1:init]
  for(i in {init+1}:n){
   mastart <- i - manum
   maend <- i-1
   arstart <- i - arnum
   arend <- i-1
   arma[i] <- sum(arcoef * arma[arstart:arend]) + sum(macoef * wn[mastart:maend])  + wn[i]
   }
  return(arma)
}
```

```{r}
#contoh untuk ARMA(2,2)
arma22 <- arma.sim(300, c(0.4, 0.6), c(0.5,0.2))

arma22 |> arima(c(2,0,2))
```
```{r}
set.seed(1048)

n <- 300
phi1 <- 0.4
phi2 <- -0.6
theta1 <- 0.5
theta2 <- 0.2

wn <- rnorm(n)

y.arma <- numeric(n)
y.arma[1:2] <- wn[1:2]   # nilai awal biar gak NA

for (i in 3:n) {
  y.arma[i] <- phi1 * y.arma[i-1] + 
               phi2 * y.arma[i-2] + 
               theta1 * wn[i-1] + 
               theta2 * wn[i-2] + 
               wn[i]
}

y.arma
```
```{r}
ts.plot(y.arma, main="Simulasi ARMA(2,2)")
```
### arima.sim
```{r}
arma22 <- arima.sim(
  list(order = c(2,0,2), ar = c(0.5, 0.2), ma = c(0.4, 0.6)),
  n = 300
)
arma22
```
## Karakteristik ARMA(2,2)
### Plot Time Series
```{r}
par(mfrow = c(1, 2))
ts.plot(y.arma)
ts.plot(arma22)
```
Berdasarkan plot time series tersebut, terlihat bahwa model ARMA(2,2) cenderung stasioner dalam rataan

### Ploat ACF
```{r}
par(mfrow = c(1, 2))
acf(y.arma)
acf(arma22)
```
Berdasarkan plot ACF tersebut, terlihat bahwa model ARMA(2,2) hasil simulasi memiliki plot ACF yang tails off, sesuai dengan teori yang ada.

### Plot PACF
```{r}
par(mfrow = c(1, 2))
pacf(y.arma)
pacf(arma22)
```
Berdasarkan plot PACF tersebut, terlihat bahwa model ARMA(2,2) hasil simulasi memiliki plot PACF yang tails off, sesuai dengan teori

### Plot EACF
```{r}
TSA::eacf(y.arma)
```
Berdasarkan hasil EACF, pola segitiga muncul di (2,2) sehingga mengarah pada ARMA(2,2).

## Scatterplot antar lag
### Korelasi antara Yt dengan Yt-1

```{r}
#Yt
yt_arma <- arma22[-1]
yt_arma
```
```{r}
#Yt-1
yt_1_arma <- arma22[-300]
yt_1_arma
```
```{r}
plot(y=yt_arma,x=yt_1_arma)
```
Berdasarkan scatterplot tersebut, terlihat bahwa terdapat hubungan positif antara $Y_t$ dengan $Y_t−1$. Hal ini sesuai dengan teori yang ada.
```{r}
cor(yt_arma,yt_1_arma)
```
Untuk model ARMA(2,2):
$$
\gamma_0 = (1+\theta_1^2+\theta_2^2)\sigma^2 
           + \phi_1 \theta_1 \sigma^2 + \phi_2 \theta_2 \sigma^2 
           + \phi_1 \theta_1 \theta_2 \sigma^2=(1+0.4^2+0.6^2)\sigma^2+0.5(0.4)\sigma^2+0.2(0.6)\sigma^2+0.5(0.4)(0.4)\sigma^2=1.92\sigma^2
$$

$$
\gamma_1 = (\theta_1 + \theta_1\theta_2 + \phi_1 + \phi_1\theta_1)\sigma^2 
           + \phi_2 \gamma_0=(0.4+0.4(0.6)+0.5+0.5(0.4))\sigma^2+0.2(1.92\sigma^2)=1.724\sigma^2
$$

$$
\gamma_2 = \theta_2 \sigma^2 + \phi_1 \gamma_1 + \phi_2 \gamma_0=0.6\sigma^2+0.5(1.724\sigma^2)+0.2(1.92\sigma^2)=1.846\sigma^2
$$

$$
\gamma_3 = \phi_1 \gamma_2 + \phi_2 \gamma_1=0.5(1.846\sigma^2)+0.2(1.724\sigma^2)=1.2678\sigma^2
$$

Sehingga autokorelasi:
$$
\rho_1 = \frac{\gamma_1}{\gamma_0}=\frac{1.724\sigma^2}{1.92\sigma^2}= 0.8979
$$
### Korelasi antara Yt dengan Yt-2

```{r}
#Yt 
yt_arma2 <- arma22[-c(1,2)] 
yt_arma2
```
```{r}
#Yt-1 
yt_1_arma2 <- arma22[-c(299,300)] 
yt_1_arma2
```
```{r}
plot(y=yt_arma2,x=yt_1_arma2)
```
Berdasarkan scatterplot tersebut, terlihat bahwa terdapat hubungan positif antara $Y_t$ dengan $Y_t−1$. Hal ini sesuai dengan teori yang ada.
```{r}
cor(yt_arma2,yt_1_arma2)  
```

$$ 
\rho_2 = \frac{\gamma_2}{\gamma_0} = \frac{1.846\sigma^2}{1.92\sigma^2}=0.9614
$$
### Korelasi antara Yt dengan Yt-3
```{r}
#Yt  
yt_arma3 <- arma22[-c(1,2,3)]  
yt_arma3
```
```{r}
#Yt-1  
yt_1_arma3 <- arma22[-c(298,299,300)]  
yt_1_arma3
```
```{r}
plot(y=yt_arma3,x=yt_1_arma3)
```
Berdasarkan scatterplot tersebut, terlihat bahwa terdapat hubungan positif antara $Y_t$ dengan $Y_t−1$. Hal ini sesuai dengan teori yang ada.
```{r}
cor(yt_arma3,yt_1_arma3)  
```
$$ \rho_3 = \frac{\gamma_3}{\gamma_0}=\frac{1.2678\sigma^2}{1.92\sigma^2}=0,66 $$
